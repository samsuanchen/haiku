<html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<title>Forth Haiku Editor</title>
<meta http-equiv="X-UA-Compatible" content="chrome=1">
<link rel="stylesheet" type="text/css" href="./Forth Haiku/Forth Haiku Editor_files/forthsalon.css">
<meta name="viewport" content="width=600">
<meta name="viewport" content="initial-scale=1.0">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
</head><body onload="init()" bgcolor="#888"><div class="section">

<div style="display:flex">
<textarea id="pre_code" hidden=1>
: 2pi pi pi + ;
: 2/ 2 / ; : 1+ 1 + ;
: r ( -- r ) \ 中心 到 x,y 距離
  x x * y y * + sqrt ;
: a ( -- a ) \ 中心 到 x,y 角度
  y x atan2 pi + 2pi / ;
\ : cx .5 ; : cy .5 ; \ p,q 原點
\ cx,cy 為 p,q 原點
: p x cx - ; : q y cy - ;
: 角 ( -- 角 ) \ p,q 到 原點 角度
\ 0 表 -pi   1 表 pi
  q p atan2 pi + 2pi / ;
: 距 ( -- 距 ) \ p,q 到 原點 距離
  p p * q q * + sqrt ;
: 內 ( x v -- b ) < ; \ x<v 區
: 外 ( x v -- b ) > ; \ x>v 區
: 間 ( x L U -- b ) \ x 在 L U 間
  >r over r> < >r > r> and ;
: 圓 ( v -- b ) 距 > ; \ 距<v 區
: 洞 ( v -- b ) 距 < ; \ 距>v 區
: 線 ( r v -- b )
  - abs .01 < ; \ f(x,y,t)=0
: 圈 距 線 ;
: 反 1 swap - ;
: 暈 - .2 ** 反 ; \ f(x,y,t)=0
: 層 dup >r * dup 1 mod - r> 1 - / ;
: 摺 * 1 mod ;
: 摺格 ( x y n -- v )
  dup >r 摺 swap r@ 摺 * r@ 2 * r> / * ;
: 層格 ( x y n -- v ) dup >r 層 swap r> 層 + 2 / ;
: 移 ( x n -- v ) - ; \ x左移n
: 放 ( x n -- v ) * ; \ x區放n倍
: 縮 ( x n -- v ) / ; \ x區縮n倍
: 絕對 ( x -- v ) abs ; \ 取x絕對值
: 負 ( x -- v ) negate ; \ 取x負值
: 方 ( r -- b ) \ 邊長2*r方
  p abs over < swap q abs > * ;
</textarea>
<div style="flex:1" width=256 height=256 name="haiku" onclick="onClick()" onmousemove="onMouseMove()">
   <textarea style="width: 256; height:256" onkeyup="onKeyUp()" id="src_code" rows="30">\ cx,cy 應為畫面上滑鼠所點位置的座標
\ derived from "Clock Cutout"
: 橫心 x .5 - ; \ 橫軸 -.5 ~ .5 
: 縱心 y .5 - ; \ 縱軸 -.5 ~ .5
: x ( t -- x(t) ) dup cos 橫心 *
  swap sin 縱心 * - ; \ 橫軸向右正
: y ( t -- y(t) ) dup sin 橫心 *
  swap cos 縱心 * + ; \ 縱軸向上正
: 畫針 ( t p1 p2 -- v ) >r >r >r
  r@ ( t ) y abs 1.012 - negate 
  200 **
  r> ( y(t) t ) x
  r> ( y(t) x(t) p2 ) - abs
  r> ( y(t) x'(t) p1 ) < * ;
: 轉角 2 * 1.5 + pi * ;
: 秒針 t floor 60 / 轉角
  .14 .23 畫針 10 / ;
: 分針 t     3600 / 轉角
  .12 .17 畫針  3 / ;
: 時針 t    43200 / 轉角
  .05 .11 畫針      ;
: 心 橫心 縱心 ; : sq dup * ;
: r 心 sq swap sq + sqrt ;
: 時標 心 atan2  6 * .5 pi * +
  sin abs 9 ** 
  r .39  > r .43 < *  * + ;
: 分標 心 atan2 30 * .5 pi * +
  sin abs 9 **
  r .422 > r .43 < *  * + ;
: flip 1 swap - ;
: 秒標 分標 ;
秒針 秒標 ( 紅 ) 分針 分標 ( 綠 )
時針 時標 ( 藍 )
: 去框 橫心 2 * sq 縱心 2 * sq
  + 9 ** flip ; 去框</textarea>
   <a name="animated" style="display: none;">a</a>
</div>
<!--
<div style="flex:1" width=256 height=256 name="haiku" onclick="onClick()" onmousemove="onMouseMove()" class="crosshair">
   <textarea style="width: 256; height:256" onkeyup="onKeyUp()" id="src_code" rows="30"></textarea>
</div>
<div style="flex:1" width=256 height=256 name="haiku" onclick="onClick()" onmousemove="onMouseMove()" class="crosshair">
   <textarea style="width: 256; height:256" onkeyup="onKeyUp()" id="src_code" rows="30"></textarea>
</div>
<div style="flex:1" width=256 height=256 name="haiku" onclick="onClick()" onmousemove="onMouseMove()" class="crosshair">
   <textarea style="width: 256; height:256" onkeyup="onKeyUp()" id="src_code" rows="30"></textarea>
</div>
-->
</div>

<div id="mous"> 000, 000 clicked 000, 000</div>
<span id="tag_area">style:short | chars:93 | words:28 | lines:4,8,6,10</span>

<script type="text/javascript" src="./Forth Haiku/Forth Haiku Editor_files/haiku.js"></script>
<script type="text/javascript">
var x,y,click={x:0,y:0};
var e=0.005;
function onMouseMove(){
  x=event.pageX/256+e;
  y=(512-event.pageY)/256+e;
  if(x>=0 && x<=1 && y>=0 && y<=1)
  	showMouse(x,y);
//	update_tags();
}
function showMouse(x,y){
  mous.innerHTML=d4(x)+','+d4(y)+' click at '+d4(click.x)+','+d4(click.y);
}
function d4(n){
  if(n>e){
    var v=n.toString().substr(0,4);
    return ' '+v+"00".substr(0,4-v.toString().length);
  }
  return " 0.00"
}
function onClick(){
  if(x>=0 && x<=1 && y>=0 && y<=1){
	click={x:x,y:y};
	update_tags();
  }
}
function init() {
  var s=localStorage.getItem('myHaikuSrc');
  if(s)
    src_code.value=s;
  var c=localStorage.getItem('myClick');
  if(c)
    click=JSON.parse(c);
  showMouse(x,y);
  animate_haikus(function() {
  });
}
function onKeyUp(){
  update_tags();
}
function update_tags() {
  var s=src_code.value;
  if(s!==localStorage.getItem('myHaikuSrc'))
    localStorage.setItem('myHaikuSrc',s);
  var c=JSON.stringify(click);
  if(c!==localStorage.getItem('myClick'))
    localStorage.setItem('myClick',c);
  tag_area.innerHTML = code_tags(s).join(' | ');
}
</script></div></body></html>