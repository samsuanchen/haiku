<html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<title>Forth Haiku Editor</title>
<meta http-equiv="X-UA-Compatible" content="chrome=1">
<link rel="stylesheet" type="text/css" href="./Forth Haiku/Forth Haiku Editor_files/forthsalon.css">
<meta name="viewport" content="width=600">
<meta name="viewport" content="initial-scale=1.0">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
</head><body onload="init()" bgcolor="#888"><div class="section">

<div style="display:flex">
<textarea id="pre_code" hidden=1>
: 2pi pi pi + ;
: 2/ 2 / ; : 1+ 1 + ;
\ : cx .5 ; : cy .5 ; \ p,q 原點
\ cx,cy 應可預設為點滑鼠定原點
: p x cx - ; : q y cy - ;
: 角 ( -- 角 ) \ p,q 到 原點 角度
\ 0 表 -pi   1 表 pi
  q p atan2 pi + 2pi / ;
: 距 ( -- 距 ) \ p,q 到 原點 距離
  p p * q q * + sqrt ;
: 內 ( x v -- b ) < ; \ x<v 區
: 外 ( x v -- b ) > ; \ x>v 區
: 間 ( x L U -- b ) \ x 在 L U 間
  >r over r> < >r > r> and ;
: 圓 ( v -- b ) 距 > ; \ 距<v 區
: 洞 ( v -- b ) 距 < ; \ 距>v 區
: 線 ( r v -- b )
  - abs .01 < ; \ f(x,y,t)=0
: 圈 距 線 ;
: 反 1 swap - ;
: 暈 - .2 ** 反 ; \ f(x,y,t)=0
: 層 dup >r * dup 1 mod - r> / ;
: 摺 * 1 mod ;
: 移 ( x n -- v ) - ; \ x左移n
: 放 ( x n -- v ) * ; \ x區放n倍
: 縮 ( x n -- v ) / ; \ x區縮n倍
</textarea>
<div style="flex:1" width=256 height=256 name="haiku" onclick="onClick()" onmousemove="onMouseMove()">
   <textarea style="width: 256; height:256" onkeyup="onKeyUp()" id="src_code" rows="30">\ cx,cy 應為畫面上滑鼠所點位置的座標
: 風扇
  角 t + 4 摺 \ 紅 4葉風扇正轉
  0 \ 無 綠
  0 \ 無 藍
  距 7 層 反  .45 圓 *  \ 透視
;   風扇
\ .2 圓 .25 圈 .3 洞
\ x 10 層 y 10 層 + 2/
\ x y + 2/ 10 層 
\ x 1 + y - 2/ 10 層 + 2/
\ a 20 層
\ x 5 摺
\ : t t 5 縮 ; \ t 慢 5 倍
\ : x x t + ; \ x 原點 隨 t 左移
\ : x x 2pi * 3 * ; \ x 區間放大
\ : y y .5 移 ; \ y 原點 移到 中間
\ : y y 4 放 ; \ y 區間放大
\ : f x sin ; \ f 為 x 的 正旋波
\ y f 暈 \ y 等於 f 的暈
\ y f 線 \ y 等於 f 的線
\ 角 t - 3 摺 \ 3葉扇正轉
\ 角 t + 3 摺 \ 3葉扇反轉
\ 距 t - 3 摺 \ 3圈放射</textarea>
   <a name="animated" style="display: none;">a</a>
</div>
<!--
<div style="flex:1" width=256 height=256 name="haiku" onclick="onClick()" onmousemove="onMouseMove()" class="crosshair">
   <textarea style="width: 256; height:256" onkeyup="onKeyUp()" id="src_code" rows="30"></textarea>
</div>
<div style="flex:1" width=256 height=256 name="haiku" onclick="onClick()" onmousemove="onMouseMove()" class="crosshair">
   <textarea style="width: 256; height:256" onkeyup="onKeyUp()" id="src_code" rows="30"></textarea>
</div>
<div style="flex:1" width=256 height=256 name="haiku" onclick="onClick()" onmousemove="onMouseMove()" class="crosshair">
   <textarea style="width: 256; height:256" onkeyup="onKeyUp()" id="src_code" rows="30"></textarea>
</div>
-->
</div>

<div id="mous"> 000, 000 clicked 000, 000</div>
<span id="tag_area">style:short | chars:93 | words:28 | lines:4,8,6,10</span>

<script type="text/javascript" src="./Forth Haiku/Forth Haiku Editor_files/haiku.js"></script>
<script type="text/javascript">
var x,y,click={x:0,y:0};
var e=0.005;
function onMouseMove(){
  x=event.pageX/256+e;
  y=(512-event.pageY)/256+e;
  if(x>=0 && x<=1 && y>=0 && y<=1)
  	showMouse(x,y);
//	update_tags();
}
function showMouse(x,y){
  mous.innerHTML=d4(x)+','+d4(y)+' click at '+d4(click.x)+','+d4(click.y);
}
function d4(n){
  if(n>e){
    var v=n.toString().substr(0,4);
    return ' '+v+"00".substr(0,4-v.toString().length);
  }
  return " 0.00"
}
function onClick(){
  if(x>=0 && x<=1 && y>=0 && y<=1){
	click={x:x,y:y};
	update_tags();
  }
}
function init() {
  var s=localStorage.getItem('myHaikuSrc');
  if(s)
    src_code.value=s;
  var c=localStorage.getItem('myClick');
  if(c)
    click=JSON.parse(c);
  showMouse(x,y);
  animate_haikus(function() {
  });
}
function onKeyUp(){
  update_tags();
}
function update_tags() {
  var s=src_code.value;
  if(s!==localStorage.getItem('myHaikuSrc'))
    localStorage.setItem('myHaikuSrc',s);
  var c=JSON.stringify(click);
  if(c!==localStorage.getItem('myClick'))
    localStorage.setItem('myClick',c);
  tag_area.innerHTML = code_tags(s).join(' | ');
}
</script></div></body></html>